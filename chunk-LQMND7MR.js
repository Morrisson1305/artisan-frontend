import{a as q}from"./chunk-N35DKANW.js";import{a as R}from"./chunk-TKIRZA44.js";import{b as H,j as G}from"./chunk-ZUXIL7TL.js";import{$b as V,Ab as u,Bb as M,Cb as A,Da as s,Ia as S,Oa as $,S as j,Sa as c,Vb as T,Wb as k,X as O,Xb as F,Za as p,Zb as B,_b as L,a as I,b as y,ca as x,cb as n,da as _,db as i,fb as U,gb as w,hb as J,jb as E,kb as g,p as v,sb as N,tb as o,ub as b,vb as d,yb as P,zb as m}from"./chunk-EUQM6YRV.js";var C=(l=>(l.OPEN="open",l.ASSIGNED="assigned",l.COMPLETED="completed",l.CANCELLED="cancelled",l))(C||{});var f=class a{constructor(t){this.http=t}baseUrl=R.baseUrl;getAllJobs(){return this.http.get(`${this.baseUrl}`)}getUserJobs(t){return this.http.get(`${this.baseUrl}/my`,{params:{userId:t}})}getUserNotifications(t){return this.http.get("/api/notifications",{params:{userId:t}})}getJobById(t){return this.http.get(`${this.baseUrl}/${t}`)}createJob(t,e){return this.http.post(`${this.baseUrl}`,y(I({},t),{code:e}))}updateJobStatus(t,e){return this.http.patch(`${this.baseUrl}/${t}/status`,{status:e})}static \u0275fac=function(e){return new(e||a)(O(H))};static \u0275prov=j({token:a,factory:a.\u0275fac,providedIn:"root"})};var Q=(a,t,e,r)=>({"bg-blue-100 text-blue-600":a,"bg-yellow-100 text-yellow-600":t,"bg-gray-100 text-gray-600":e,"bg-red-100 text-red-600":r});function X(a,t){if(a&1){let e=J();n(0,"div",18)(1,"p",4),o(2,"No jobs posted yet"),i(),n(3,"button",19),E("click",function(){x(e);let l=g(2);return _(l.openJobModal())}),o(4,"\u2795 Post Your First Job"),i()()}}function Z(a,t){if(a&1&&(n(0,"div",22)(1,"div",23)(2,"h4",24),o(3),i(),n(4,"p",4),o(5),i(),n(6,"div",25)(7,"span"),o(8),i(),n(9,"span"),o(10),m(11,"date"),i()()(),n(12,"div",26)(13,"span",27),o(14),i(),n(15,"button",28),o(16,"View Details"),i()()()),a&2){let e=t.$implicit,r=g(3);s(3),b(e.title),s(2),b(e.description),s(3),d("\u{1F4CD} ",e.location,""),s(2),d("\u{1F552} ",M(11,6,e.createdAt,"mediumDate"),""),s(3),p("ngClass",P(9,Q,e.status===r.JobStatus.OPEN,e.status===r.JobStatus.ASSIGNED,e.status===r.JobStatus.COMPLETED,e.status===r.JobStatus.CANCELLED)),s(),d(" ",e.status," ")}}function ee(a,t){if(a&1&&(n(0,"div",20),c(1,Z,17,14,"div",21),i()),a&2){let e=g().ngIf;s(),p("ngForOf",e)}}function te(a,t){if(a&1&&(U(0),c(1,X,5,0,"div",16)(2,ee,2,1,"div",17),w()),a&2){let e=t.ngIf;s(),p("ngIf",e.length===0),s(),p("ngIf",e.length>0)}}function ie(a,t){a&1&&(n(0,"div",4),o(1,"Loading jobs..."),i())}var W=class a{constructor(t,e){this.authService=t;this.jobService=e}user;JobStatus=C;jobs$;activeJobs$;completedJobs$;totalSpent$;showJobPostModal=!1;ngOnInit(){this.user=this.authService.getUser();let t=this.user?.id;t&&(this.jobs$=this.jobService.getUserJobs(t),this.activeJobs$=this.jobs$.pipe(v(e=>e.filter(r=>r.status==="open"||r.status==="assigned"))),this.completedJobs$=this.jobs$.pipe(v(e=>e.filter(r=>r.status==="completed"))),this.totalSpent$=this.completedJobs$.pipe(v(e=>e.reduce((r,l)=>r+(l.finalAmount||0),0))))}openJobModal(){this.showJobPostModal=!0}closeJobModal(){this.showJobPostModal=!1}static \u0275fac=function(e){return new(e||a)(S(q),S(f))};static \u0275cmp=$({type:a,selectors:[["app-user-dashboard"]],decls:47,vars:14,consts:[["loading",""],[1,"dashboard-container"],[1,"dashboard-header"],[1,"text-3xl","mb-2"],[1,"text-gray-600"],[1,"post-job-btn",3,"click"],[1,"stats-grid"],[1,"card","blue"],[1,"card-content"],[1,"text-gray-500"],[1,"icon-circle"],[1,"card","green"],[1,"card","gray"],[1,"card","job-list-card"],[1,"text-lg","mb-4"],[4,"ngIf","ngIfElse"],["class","text-center",4,"ngIf"],["class","job-list divide-y",4,"ngIf"],[1,"text-center"],[1,"post-job-btn","mt-4",3,"click"],[1,"job-list","divide-y"],["class","job-item",4,"ngFor","ngForOf"],[1,"job-item"],[1,"flex-1"],[1,"text-lg","font-medium"],[1,"job-meta","text-sm","text-gray-500","mt-2"],[1,"job-actions"],[1,"status-badge",3,"ngClass"],[1,"view-btn","hover:underline","mt-2"]],template:function(e,r){if(e&1){let l=J();n(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),o(4),i(),n(5,"p",4),o(6,"Manage your service requests and track ongoing projects"),i()(),n(7,"button",5),E("click",function(){return x(l),_(r.openJobModal())}),o(8," \u2795 Post New Job "),i()(),n(9,"div",6)(10,"div",7)(11,"div",8)(12,"div")(13,"p",9),o(14,"Active Jobs"),i(),n(15,"h2"),o(16),m(17,"async"),i()(),n(18,"div",10),o(19,"\u{1F4BC}"),i()()(),n(20,"div",11)(21,"div",8)(22,"div")(23,"p",9),o(24,"Completed"),i(),n(25,"h2"),o(26),m(27,"async"),i()(),n(28,"div",10),o(29,"\u2705"),i()()(),n(30,"div",12)(31,"div",8)(32,"div")(33,"p",9),o(34,"Total Spent"),i(),n(35,"h2"),o(36),m(37,"async"),i()(),n(38,"div",10),o(39,"\u{1F4B0}"),i()()()(),n(40,"div",13)(41,"h3",14),o(42,"Recent Jobs"),i(),c(43,te,3,2,"ng-container",15),m(44,"async"),c(45,ie,2,0,"ng-template",null,0,A),i()()}if(e&2){let l,h,D,Y=N(46);s(4),d("Welcome back, ",r.user==null?null:r.user.username,"!"),s(12),b(((l=u(17,6,r.activeJobs$))==null?null:l.length)||0),s(10),b(((h=u(27,8,r.completedJobs$))==null?null:h.length)||0),s(10),d("$",((D=u(37,10,r.totalSpent$))==null?null:D.toFixed(2))||"0.00",""),s(7),p("ngIf",u(44,12,r.jobs$))("ngIfElse",Y)}},dependencies:[V,T,k,F,B,L,G],encapsulation:2})};export{W as UserDashboardComponent};
