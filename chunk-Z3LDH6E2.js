import{a as q}from"./chunk-5QEJCEUV.js";import{a as R}from"./chunk-MXJ22REZ.js";import{$a as T,Aa as f,D as j,G as O,Ha as P,Ia as n,Ja as b,K as x,Ka as m,L as _,Na as w,Oa as p,Pa as u,Qa as N,Ra as A,_ as s,a as y,ab as k,b as I,bb as F,ca as S,db as B,eb as L,fa as $,fb as V,ib as H,j as v,ja as c,na as d,qb as G,sa as i,ta as t,va as U,wa as M,xa as E,za as J}from"./chunk-O67RTWPF.js";var C=(l=>(l.OPEN="open",l.ASSIGNED="assigned",l.COMPLETED="completed",l.CANCELLED="cancelled",l))(C||{});var g=class a{constructor(o){this.http=o}baseUrl=R.baseUrl;getAllJobs(){return this.http.get(`${this.baseUrl}`)}getUserJobs(o){return this.http.get(`${this.baseUrl}/my`,{params:{userId:o}})}getUserNotifications(o){return this.http.get("/api/notifications",{params:{userId:o}})}getJobById(o){return this.http.get(`${this.baseUrl}/${o}`)}createJob(o,e){return this.http.post(`${this.baseUrl}`,I(y({},o),{code:e}))}updateJobStatus(o,e){return this.http.patch(`${this.baseUrl}/${o}/status`,{status:e})}static \u0275fac=function(e){return new(e||a)(O(H))};static \u0275prov=j({token:a,factory:a.\u0275fac,providedIn:"root"})};var Q=(a,o,e,r)=>({"bg-blue-100 text-blue-600":a,"bg-yellow-100 text-yellow-600":o,"bg-gray-100 text-gray-600":e,"bg-red-100 text-red-600":r});function X(a,o){if(a&1){let e=E();i(0,"div",24)(1,"p",10),n(2,"No jobs posted yet"),t(),i(3,"button",25),J("click",function(){x(e);let l=f(2);return _(l.openJobModal())}),n(4,"\u2795 Post Your First Job"),t()()}}function Z(a,o){if(a&1&&(i(0,"div",28)(1,"div",29)(2,"h4",30),n(3),t(),i(4,"p",10),n(5),t(),i(6,"div",31)(7,"span"),n(8),t(),i(9,"span"),n(10),p(11,"date"),t()()(),i(12,"div",32)(13,"span",33),n(14),t(),i(15,"button",34),n(16,"View Details"),t()()()),a&2){let e=o.$implicit,r=f(3);s(3),b(e.title),s(2),b(e.description),s(3),m("\u{1F4CD} ",e.location,""),s(2),m("\u{1F552} ",N(11,6,e.createdAt,"mediumDate"),""),s(3),d("ngClass",w(9,Q,e.status===r.JobStatus.OPEN,e.status===r.JobStatus.ASSIGNED,e.status===r.JobStatus.COMPLETED,e.status===r.JobStatus.CANCELLED)),s(),m(" ",e.status," ")}}function ee(a,o){if(a&1&&(i(0,"div",26),c(1,Z,17,14,"div",27),t()),a&2){let e=f().ngIf;s(),d("ngForOf",e)}}function te(a,o){if(a&1&&(U(0),c(1,X,5,0,"div",22)(2,ee,2,1,"div",23),M()),a&2){let e=o.ngIf;s(),d("ngIf",e.length===0),s(),d("ngIf",e.length>0)}}function ie(a,o){a&1&&(i(0,"div",10),n(1,"Loading jobs..."),t())}var W=class a{constructor(o,e){this.authService=o;this.jobService=e}user;JobStatus=C;jobs$;activeJobs$;completedJobs$;totalSpent$;showJobPostModal=!1;ngOnInit(){this.user=this.authService.getUser();let o=this.user?.id;o&&(this.jobs$=this.jobService.getUserJobs(o),this.activeJobs$=this.jobs$.pipe(v(e=>e.filter(r=>r.status==="open"||r.status==="assigned"))),this.completedJobs$=this.jobs$.pipe(v(e=>e.filter(r=>r.status==="completed"))),this.totalSpent$=this.completedJobs$.pipe(v(e=>e.reduce((r,l)=>r+(l.finalAmount||0),0))))}openJobModal(){this.showJobPostModal=!0}closeJobModal(){this.showJobPostModal=!1}static \u0275fac=function(e){return new(e||a)(S(q),S(g))};static \u0275cmp=$({type:a,selectors:[["app-user-dashboard"]],decls:60,vars:14,consts:[["loading",""],[1,"dashboard-layout"],[1,"sidebar"],[1,"sidebar-title"],[1,"sidebar-nav"],["href","#",1,"nav-link","active"],["href","#"],[1,"dashboard-container"],[1,"dashboard-header"],[1,"text-3xl","mb-2"],[1,"text-gray-600"],[1,"post-job-btn",3,"click"],[1,"stats-grid"],[1,"card","blue"],[1,"card-content"],[1,"text-gray-500"],[1,"icon-circle"],[1,"card","green"],[1,"card","gray"],[1,"card","job-list-card"],[1,"text-lg","mb-4"],[4,"ngIf","ngIfElse"],["class","text-center",4,"ngIf"],["class","job-list divide-y",4,"ngIf"],[1,"text-center"],[1,"post-job-btn","mt-4",3,"click"],[1,"job-list","divide-y"],["class","job-item",4,"ngFor","ngForOf"],[1,"job-item"],[1,"flex-1"],[1,"text-lg","font-medium"],[1,"job-meta","text-sm","text-gray-500","mt-2"],[1,"job-actions"],[1,"status-badge",3,"ngClass"],[1,"view-btn","hover:underline","mt-2"]],template:function(e,r){if(e&1){let l=E();i(0,"div",1)(1,"aside",2)(2,"h2",3),n(3,"CraftConnect"),t(),i(4,"nav",4)(5,"a",5),n(6,"Dashboard"),t(),i(7,"a",6),n(8,"My Jobs"),t(),i(9,"a",6),n(10,"Messages"),t(),i(11,"a",6),n(12,"Profile"),t()()(),i(13,"div",7)(14,"div",8)(15,"div")(16,"h1",9),n(17),t(),i(18,"p",10),n(19,"Manage your service requests and track ongoing projects"),t()(),i(20,"button",11),J("click",function(){return x(l),_(r.openJobModal())}),n(21," \u2795 Post New Job "),t()(),i(22,"div",12)(23,"div",13)(24,"div",14)(25,"div")(26,"p",15),n(27,"Active Jobs"),t(),i(28,"h2"),n(29),p(30,"async"),t()(),i(31,"div",16),n(32,"\u{1F4BC}"),t()()(),i(33,"div",17)(34,"div",14)(35,"div")(36,"p",15),n(37,"Completed"),t(),i(38,"h2"),n(39),p(40,"async"),t()(),i(41,"div",16),n(42,"\u2705"),t()()(),i(43,"div",18)(44,"div",14)(45,"div")(46,"p",15),n(47,"Total Spent"),t(),i(48,"h2"),n(49),p(50,"async"),t()(),i(51,"div",16),n(52,"\u{1F4B0}"),t()()()(),i(53,"div",19)(54,"h3",20),n(55,"Recent Jobs"),t(),c(56,te,3,2,"ng-container",21),p(57,"async"),c(58,ie,2,0,"ng-template",null,0,A),t()()()}if(e&2){let l,h,D,Y=P(59);s(17),m("Welcome back, ",r.user==null?null:r.user.username,"!"),s(12),b(((l=u(30,6,r.activeJobs$))==null?null:l.length)||0),s(10),b(((h=u(40,8,r.completedJobs$))==null?null:h.length)||0),s(10),m("$",((D=u(50,10,r.totalSpent$))==null?null:D.toFixed(2))||"0.00",""),s(7),d("ngIf",u(57,12,r.jobs$))("ngIfElse",Y)}},dependencies:[V,T,k,F,B,L,G],encapsulation:2})};export{W as UserDashboardComponent};
