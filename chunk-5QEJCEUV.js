import{a as u,b as p}from"./chunk-MXJ22REZ.js";import{A as a,D as n,G as s,T as i,Wa as h,ib as g}from"./chunk-O67RTWPF.js";var l=class r{constructor(t,e){this.authStorage=t;this.http=e;let c=this.authStorage.getUser(),o=this.authStorage.getAccessToken();o&&!this.authStorage.isTokenExpired(o)?this.user.set(c):(this.authStorage.clear(),this.user.set(null)),this.isLoading.set(!1)}user=i(null);isLoading=i(!0);baseUrl=u.baseUrl;login(t){return this.http.post(`${this.baseUrl}/auth/login`,t)}verifyLoginOtp(t){return this.http.post(`${this.baseUrl}/auth/login/verify`,t).pipe(a(e=>{this.authStorage.setUser(e.user),this.authStorage.setTokens(e.accessToken,e.refreshToken),this.user.set(e.user)}))}register(t){return this.http.post(`${this.baseUrl}/auth/register`,t)}verifyOtp(t){return this.http.post(`${this.baseUrl}/auth/verify-otp`,t)}resendOtp(t){return this.http.post(`${this.baseUrl}/auth/resend-otp`,t)}logout(){this.authStorage.clear(),this.user.set(null)}get authState(){return h(()=>({user:this.user(),isAuthenticated:!!this.user(),isLoading:this.isLoading()}))}getUser(){return this.user()}getAccessToken(){return this.authStorage.getAccessToken()}getRefreshToken(){return this.authStorage.getRefreshToken()}static \u0275fac=function(e){return new(e||r)(s(p),s(g))};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
