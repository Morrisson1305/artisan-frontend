import{n as x,p as w,q as J,r as T,s as k,v as D,w as j}from"./chunk-2Z7SZSBB.js";import{l as P,p as y,w as I,x as S}from"./chunk-MKBBIRY7.js";import{Ab as M,Ga as a,La as c,Ra as O,V as f,Wa as C,_ as h,cb as p,hb as o,ib as i,oa as b,ob as l,pb as _,ta as v,yb as r,z as u,zb as g}from"./chunk-4FBGXZMF.js";var d=class s{constructor(t){this.http=t}baseUrl=`${D.baseUrl}/jobs`;getJobs(t={}){let e=new I;return t.status&&(e=e.set("status",t.status)),t.category&&(e=e.set("category",t.category)),this.http.get(this.baseUrl,{params:e})}getJobById(t){return this.http.get(`${this.baseUrl}/${t}`)}getUserJobs(t){return this.http.get(`${this.baseUrl}/user/${t}`)}createJob(t){return this.http.post(`${this.baseUrl}`,t)}verifyJobOTP(t){return this.http.post(`${this.baseUrl}/verify-otp`,t)}updateJob(t,e){return this.http.put(`${this.baseUrl}/${t}`,e)}deleteJob(t){return this.http.delete(`${this.baseUrl}/${t}`)}updateJobStatus(t,e){return this.http.patch(`${this.baseUrl}/${t}/status`,{status:e})}acceptBid(t){return this.http.post(`${this.baseUrl}/accept-bid`,t)}getBidsForJob(t){return this.http.get(`${this.baseUrl}/${t}/bids`)}static \u0275fac=function(e){return new(e||s)(h(S))};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})};function R(s,t){if(s&1&&(o(0,"span"),r(1," Resend OTP in "),o(2,"strong"),r(3),i(),r(4,"s "),i()),s&2){let e=_();a(3),g(e.countdown)}}var $=class s{constructor(t,e,n,m){this.jobService=t;this.toast=e;this.dialogRef=n;this.data=m;this.startTimer()}verified=new b;showToast=new b;otpCode="";countdown=300;canResend=!1;timerSub;isSubmitting=v(!1);config={length:5,inputClass:"otp-input",allowNumbersOnly:!0,isPasswordInput:!1,autofocus:!0,placeholder:""};startTimer(){this.countdown=300,this.canResend=!1,this.timerSub?.unsubscribe(),this.timerSub=u(1e3).subscribe(()=>{this.countdown--,this.countdown<=0&&(this.canResend=!0,this.timerSub.unsubscribe())})}onOtpChange(t){this.otpCode=t}handleSubmit(){if(!this.otpCode||this.otpCode.length!==5){this.toast.warning("Please enter the 5-digit OTP code");return}this.isSubmitting.set(!0);let t={phone:this.data.phone,jobId:this.data.jobId,otp:this.otpCode};this.jobService.verifyJobOTP(t).subscribe({next:()=>{this.toast.success("OTP verification successful"),this.isSubmitting.set(!1),this.verified.emit(),this.dialogRef.close()},error:e=>{let n=e?.error?.message||"Invalid or expired OTP";this.toast.error(n),this.showToast.emit(n),this.isSubmitting.set(!1)}})}ngOnDestroy(){this.timerSub?.unsubscribe()}get phone(){return this.data.phone}static \u0275fac=function(e){return new(e||s)(c(d),c(j),c(T),c(k))};static \u0275cmp=O({type:s,selectors:[["app-five-digit-otp-modal"]],outputs:{verified:"verified",showToast:"showToast"},decls:16,vars:5,consts:[[1,"otp-modal-backdrop"],[1,"otp-modal"],[1,"close-btn",3,"click"],[1,"title"],[1,"subtitle"],[1,"phone"],[3,"onInputChange","config"],[1,"resend-section"],[4,"ngIf"],["type","button",1,"verify-btn",3,"click","disabled"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),l("click",function(){return n.dialogRef.close()}),r(3,"\xD7"),i(),o(4,"h2",3),r(5,"Enter OTP"),i(),o(6,"p",4),r(7," We've sent a 5-digit verification code to "),o(8,"span",5),r(9),i(),r(10,". "),i(),o(11,"ng-otp-input",6),l("onInputChange",function(U){return n.onOtpChange(U)}),i(),o(12,"div",7),C(13,R,5,1,"span",8),i(),o(14,"button",9),l("click",function(){return n.handleSubmit()}),r(15),i()()()),e&2&&(a(9),g(n.phone),a(2),p("config",n.config),a(2),p("ngIf",!n.canResend),a(),p("disabled",n.otpCode.length<5||n.isSubmitting()),a(),M(" ",n.isSubmitting()?"Verifying...":"Verify"," "))},dependencies:[y,P,x,J,w],styles:[".otp-modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:1000;display:flex;justify-content:center;align-items:center;padding:1rem}.otp-modal[_ngcontent-%COMP%]{background-color:#fff;padding:2rem 1.75rem;width:100%;max-width:420px;border-radius:1rem;position:relative;box-shadow:0 10px 30px #0003;font-family:system-ui,sans-serif;animation:_ngcontent-%COMP%_fadeIn .3s ease}.otp-modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;top:.75rem;right:1rem;background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#4b5563;transition:color .2s}.otp-modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#1f2937}.otp-modal[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:.5rem;text-align:center;color:#111827}.otp-modal[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center;color:#6b7280;font-size:.95rem;margin-bottom:1.5rem}.otp-modal[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]   .phone[_ngcontent-%COMP%]{font-weight:600;color:#111827}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]{width:2.8rem;height:2.8rem;margin:0 .25rem;font-size:1.4rem;font-weight:600;text-align:center;border:1.5px solid #d1d5db;border-radius:.5rem;background:#fff;outline:none;transition:border-color .2s,box-shadow .2s}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]:focus{border-color:#2563eb;box-shadow:0 0 0 2px #2563eb4d}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]   .verify-btn[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff;font-weight:600;border:none;border-radius:.5rem;padding:.65rem 1.75rem;font-size:1rem;cursor:pointer;transition:background-color .2s}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]   .verify-btn[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.otp-modal[_ngcontent-%COMP%]   .otp-form[_ngcontent-%COMP%]   .verify-btn[_ngcontent-%COMP%]:disabled{background-color:#93c5fd;cursor:not-allowed}.otp-modal[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin-bottom:1.25rem;text-align:center}.otp-modal[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]{color:#2563eb;cursor:pointer;text-decoration:underline;font-weight:500;transition:color .2s}.otp-modal[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]:hover{color:#1d4ed8}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}"]})};export{d as a,$ as b};
