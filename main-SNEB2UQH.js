import{a as y,b as H}from"./chunk-MXJ22REZ.js";import{H as i,fa as u,hb as h,i as a,ib as l,jb as g,kb as C,lb as v,pb as R,s as m,ua as f,y as d}from"./chunk-O67RTWPF.js";var r=class e{title="craft-connect";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(t,c){t&1&&f(0,"router-outlet")},dependencies:[v],encapsulation:2})};var b=[{path:"become-artisan",loadComponent:()=>import("./chunk-HD5NKEBU.js").then(e=>e.RegisterComponent)},{path:"login",loadComponent:()=>import("./chunk-4ZWPNAHN.js").then(e=>e.LoginComponent)},{path:"about",loadComponent:()=>import("./chunk-5GTPGG7T.js").then(e=>e.AboutComponent)},{path:"user-dashboard",loadComponent:()=>import("./chunk-Z3LDH6E2.js").then(e=>e.UserDashboardComponent)},{path:"",pathMatch:"full",loadComponent:()=>import("./chunk-SOJQBFR5.js").then(e=>e.HomeComponent)},{path:"**",redirectTo:""}];var M=(e,n)=>{let t=i(H),c=i(l),p=t.getAccessToken(),T=y.baseUrl,k=e;if(p&&!t.isTokenExpired(p)){let s=e.clone({setHeaders:{Authorization:`Bearer ${p}`}})}return n(k).pipe(m(s=>{if(s.status!==401||!t.getRefreshToken())return a(()=>s);let S=t.getRefreshToken();return c.post(`${T}/auth/refresh-token`,{refreshToken:S}).pipe(d(o=>{t.setTokens(o.accessToken,o.refreshToken);let A=e.clone({setHeaders:{Authorization:`Bearer ${o.accessToken}`}});return n(A)}),m(o=>(t.clear(),a(()=>o))))}))};h(r,{providers:[R(b),g(C([M]))]});
