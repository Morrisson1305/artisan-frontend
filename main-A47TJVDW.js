import{a as R}from"./chunk-CJ5FLLAF.js";import{ca as b,da as M}from"./chunk-QCKMTWOB.js";import{m as h,o as l,p as g,q as C,r as v,v as y}from"./chunk-QMK46LHX.js";import{D as m,S as d,Ya as f,ca as i,p as s,rb as u}from"./chunk-HI7HT6SX.js";var r=class e{title="craft-connect";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(t,c){t&1&&u(0,"router-outlet")},dependencies:[v],encapsulation:2})};var H=[{path:"",pathMatch:"full",loadComponent:()=>import("./chunk-OUSEYIUK.js").then(e=>e.HomeComponent)},{path:"become-artisan",loadComponent:()=>import("./chunk-5WVWYUEX.js").then(e=>e.RegisterComponent)},{path:"login",loadComponent:()=>import("./chunk-CO44ICNA.js").then(e=>e.LoginComponent)},{path:"about",loadComponent:()=>import("./chunk-4FBJHWZU.js").then(e=>e.AboutComponent)},{path:"user-dashboard",component:R,children:[{path:"",loadComponent:()=>import("./chunk-QP76QE4S.js").then(e=>e.UserDashboardComponent)},{path:"profile",loadComponent:()=>import("./chunk-RK7POEGF.js").then(e=>e.ProfileComponent)}]},{path:"**",redirectTo:""}];var S=(e,n)=>{let t=i(b),c=i(l),p=t.getAccessToken(),T=M.baseUrl,k=e;if(p&&!t.isTokenExpired(p)){let a=e.clone({setHeaders:{Authorization:`Bearer ${p}`}})}return n(k).pipe(m(a=>{if(a.status!==401||!t.getRefreshToken())return s(()=>a);let A=t.getRefreshToken();return c.post(`${T}/auth/refresh-token`,{refreshToken:A}).pipe(d(o=>{t.setTokens(o.accessToken,o.refreshToken);let N=e.clone({setHeaders:{Authorization:`Bearer ${o.accessToken}`}});return n(N)}),m(o=>(t.clear(),s(()=>o))))}))};h(r,{providers:[y(H),g(C([S]))]});
